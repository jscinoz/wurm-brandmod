apply plugin: "java"

defaultTasks "build"

sourceCompatibility = JavaVersion.VERSION_1_8
targetCompatibility = JavaVersion.VERSION_1_8

repositories {
  mavenCentral()
  jcenter()

  maven {
    url "http://gotti.no-ip.org/maven/repository"
  }
}

configurations {
  jarLib {
    description = "Dependencies to be included in the mod JAR"

    // Include everything from the runtime config...
    extendsFrom runtime

    // ... except the mod launcher (& dependencies) itself
    exclude group: "org.gotti.wurmunlimited"
  }
}

dependencies {
  // Also pulls in the specific version of javassist that will be available at
  // runtime
  compile group: "org.gotti.wurmunlimited", name: "server-modlauncher",
          version: "0.20"

}

tasks.withType(JavaCompile) {
  options.compilerArgs <<
    "-Werror" <<
    "-Xlint:all" <<
    "-Xlint:-processing" <<
    "-Xlint:-options" <<
    // Needed for Javassist
    "-Xlint:-classfile" <<
    "-Xdiags:verbose"
}

group = "so.jscinoz.wurmunlimited.mods"
version = "0.0.1"

jar {
  baseName = "brandmod"
  version = null

  // XXX: Figure out how to make this work. bcel still isn't found even with the
  // jar included
  /*
  manifest {
    attributes(
      "Class-Path": configurations.jarLib.collect { it.getName() }.join(" ")
    )
  }

  into("lib") {
    from {
      configurations.jarLib.each {
        println it
      }
    }
  }
  */
}
